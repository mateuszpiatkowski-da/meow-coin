module Fixture.Token where

import Meow.Holding
import Daml.Script

-- Reusable test fixture for token creation
data TokenFixture = TokenFixture with
    admin : Party
    oldOwner : Party
    newOwner : Party
    tokenCid : ContractId MeowToken
  deriving (Eq, Show)

-- Helper function to create a token with customizable metadata
createTestToken : Party -> Party -> Decimal -> Script (ContractId MeowToken)
createTestToken admin owner amount = do
  submit admin do
    createCmd MeowToken with
      admin
      owner
      amount

-- Standard test setup with default values
setupTokenTest : Decimal -> Script TokenFixture
setupTokenTest amount = do
  admin <- allocateParty "admin"
  newOwner <- allocateParty "NewOwner"
  oldOwner <- allocateParty "OldOwner"

  tokenCid <- createTestToken admin oldOwner amount

  pure TokenFixture with admin; oldOwner; newOwner; tokenCid
