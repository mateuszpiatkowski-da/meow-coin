module Fixture.Token where

import Meow.Holding
import Daml.Script
import Fixture.Parties qualified as F.Parties

-- Reusable test fixture for token creation
data TokenFixture = TokenFixture with
    admin : Party
    sender : Party
    receiver : Party
    tokenCid : ContractId MeowToken
  deriving (Eq, Show)

-- Helper function to create a token with customizable metadata
create_test_token : Party -> Party -> Decimal -> Script (ContractId MeowToken)
create_test_token admin owner amount = do
  submit admin do
    createCmd MeowToken with
      admin
      owner
      amount

-- Standard test setup with default values
setup_token_test : Decimal -> Script TokenFixture
setup_token_test amount = do
  F.Parties.Parties{admin, sender, receiver} <- F.Parties.create_parties

  tokenCid <- create_test_token admin sender amount

  pure TokenFixture with admin; sender; receiver; tokenCid
